

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Non-linear Registration &#8212; Image Registration</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6.non-linear-reg';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Summary" href="7.summary.html" />
    <link rel="prev" title="Registering Images from Different Subjects" href="5.registering-different-subs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Image Registration - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Image Registration - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.reg-problem.html">The Image Registration Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.mapping-coords.html">Mapping Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.finding-transforms.html">Finding the Best Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.applying-transforms.html">Applying Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.registering-different-subs.html">Registering Images from Different Subjects</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Non-linear Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F6.non-linear-reg.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/6.non-linear-reg.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Non-linear Registration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deformation-fields">Deformation Fields</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-deformation-fields">Creating Deformation Fields</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regularisation">Regularisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-versus-non-linear-registration">Linear Versus Non-linear Registration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unified-segmentation">Unified segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalisation-in-spm">Normalisation in <code class="docutils literal notranslate"><span class="pre">SPM</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="non-linear-registration">
<h1>Non-linear Registration<a class="headerlink" href="#non-linear-registration" title="Permalink to this heading">#</a></h1>
<p>As we saw in the last section, affine transformations alone are not enough to accurately register individual subjects to a common template space. In order to move beyond simple affine approaches, we have to consider methods where we can move each voxel <em>independently</em>. These are known as <em>non-linear</em> registration techniques. Generally, these methods are more complex than affine methods and so we will keep the detail presented here limited. However, much of the image registration theory remains relevant. We still have a <em>reference</em> image (the MNI templates) that we want to align our <em>source</em> image to. In order to do so, we still have to estimate some form of <em>mapping</em> between the source and the reference images, and this will require optimisation using some form of <em>objective function</em>. We then need to <em>resample</em> the source image to move it into standard space. The main difference is that our mapping is no longer given by a 12-parameter affine transformation. Instead, our mapping is based on a <em>deformation field</em>.​​​</p>
<section id="deformation-fields">
<h2>Deformation Fields<a class="headerlink" href="#deformation-fields" title="Permalink to this heading">#</a></h2>
<p>At its most basic, a deformation field is an image where each voxel value indicates how to move that specific voxel when warping to standard space. There are therefore three of these images, one for the <span class="math notranslate nohighlight">\(x\)</span>-axis, <span class="math notranslate nohighlight">\(y\)</span>-axis and <span class="math notranslate nohighlight">\(z\)</span>-axis. In <code class="docutils literal notranslate"><span class="pre">SPM</span></code>, the deformation field images contain the new millimetre coordinates for each voxel after warping. So the <span class="math notranslate nohighlight">\(X\)</span> deformation field contains all the new <span class="math notranslate nohighlight">\(x\)</span>-coordinates, the <span class="math notranslate nohighlight">\(Y\)</span> deformation field contains all the new <span class="math notranslate nohighlight">\(y\)</span>-coordinates and the <span class="math notranslate nohighlight">\(Z\)</span> deformation field contains all the new <span class="math notranslate nohighlight">\(z\)</span>-coordinates. So rather than using the header matrices to calculate the millimetre coordinates, we can do it directly by looking at the deformation fields. We can then convert these into voxel coordinates in the source image to give us the values we need to copy into our new normalised image. Of course, given how flexible the non-linear approach is, this will almost always need some form of interpolation.</p>
<p>An examples of a deformation field for the <span class="math notranslate nohighlight">\(x\)</span>-axis is shown below. As you navigate around the image, compare the <span class="math notranslate nohighlight">\(x\)</span>-coordinate in red to the voxel value in white. The <span class="math notranslate nohighlight">\(x\)</span>-coordinate gives the original world-space location of that voxel and the voxel value in white gives the <em>new</em> world-space coordinate where the voxel must be moved in order to warp the image to standard space. For instance, if the coordinates of the voxel are given as <span class="math notranslate nohighlight">\([-18, 12, 0]\)</span> and the voxel value is <span class="math notranslate nohighlight">\(-20.01\)</span>, this means that the voxel located at <span class="math notranslate nohighlight">\([-18, 12, 0]\)</span> must be shifted to a world-space <span class="math notranslate nohighlight">\(x\)</span>-coordinate of <span class="math notranslate nohighlight">\(-20.01\)</span>. The deformation field for the <span class="math notranslate nohighlight">\(y\)</span>-axis and <span class="math notranslate nohighlight">\(z\)</span>-axis would then be used in the same fashion to complete the new world-space coordinates.</p>
<iframe src="deform-x.html" width="800" height="600" frameborder="0" scrolling="no" title=""></iframe><div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because the deformation field defines a warping in world-space, it can be applied to <em>any</em> image that is registered with the source image. This will become important when we get get to fMRI pre-processing, as it is typical to use an aligned anatomical scan to estimate the warping, before appplying the resultant deformation field to the functional images. As such, a deformation field is <em>reuseable</em>, so long as the images are aligned in world-space.</p>
</div>
<section id="creating-deformation-fields">
<h3>Creating Deformation Fields<a class="headerlink" href="#creating-deformation-fields" title="Permalink to this heading">#</a></h3>
<p>The first step in creating a deformation field is to align the source and the target using an affine approach, in order to get the images as close as possible. So even when performing non-linear registration, the algorithm always starts by doing the best job it can with an affine transformation. As such, everything said earlier in this lesson about making sure the linear registration performs well also applies here. Issues with optimisation also remain the same, so making sure the images are as well-aligned as possible beforehand is always a good idea.</p>
<p>Next, an optimisation algorithm is used to estimate the warping needed to match the images. However, unlike an affine transformation where there are (at most) 12 parameters, non-linear registration can have <em>thousands</em> of parameters to optimise. How this is done is somewhat beyond the scope of the lesson, however, we can gain some intuition by looking at a deformation field in 1D. In <a class="reference internal" href="#deform-1d-fig"><span class="std std-numref">Fig. 10</span></a> we can see a plot of a single row (shown in blue) of the <span class="math notranslate nohighlight">\(X\)</span> deformation field. A slice has been chosen where all the voxels originally has an x-coordinate of 0mm. The orange line shows the new millimetre coordinates for all voxels from this row, indicating that they will all be shifted by different amounts to the right.</p>
<figure class="align-default" id="deform-1d-fig">
<a class="reference internal image-reference" href="_images/deform-1d.png"><img alt="_images/deform-1d.png" src="_images/deform-1d.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Illustration of a deformation field in 1D.</span><a class="headerlink" href="#deform-1d-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This orange line is what the non-linear registration estimates. It does this by taking a whole bunch of cosines of different frequencies, weighting each frequency and then summing them to create these lines. The optimisation tries to find the weights (known as the <em>coefficients</em>) that lead to a line that represent the best shift in the image coordinates to fit the template image. As with linear registration, this is about finding the weights that minimise a cost function, which for non-linear registration is usually <em>least-squares</em>. As such, it is typical to have multiple MNI templates available, such as a T1, T2 and EPI for normalising images from different modalities.</p>
</section>
</section>
<section id="regularisation">
<h2>Regularisation<a class="headerlink" href="#regularisation" title="Permalink to this heading">#</a></h2>
<p>An important element of non-linear techniques is making sure that the degree of warping applied to the images is sensible. What we do not want is to end up with biologically implausible brains that have been severely warped to suit the whims of the optimisation algorithm. As such, non-linear algorithms usually come with a way of penalising too much warping. This is known as regularisation. In <code class="docutils literal notranslate"><span class="pre">SPM</span></code>, this is done using the <em>bending energy</em> of the warp. The more extreme the bending, the larger the difference it has to make to the cost function to be allowed. In practise, this means that biologically implausible warps should be penalised and not allowed to happen. The consequences of reducing the amount of regularisation is shown in <a class="reference internal" href="#regularisation-fig"><span class="std std-numref">Fig. 11</span></a>.</p>
<figure class="align-default" id="regularisation-fig">
<a class="reference internal image-reference" href="_images/regularisation.png"><img alt="_images/regularisation.png" src="_images/regularisation.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Illustration of a how a reduction in regularisation affects the warping.</span><a class="headerlink" href="#regularisation-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Reducing the degree of regularisation can cause some extreme results in terms of what the non-linear warping does to the image. Messing with the regularisation is therefore not often advisable, unless you find your images are being excessively warped and you need to increase the penalty. However, what this does demonstrate is that non-linear registration is a balance between minimising the cost function, but without producing extreme warps. This balance is, in part, why perfect non-linear registration will almost never be achievable.</p>
</div>
</section>
<section id="linear-versus-non-linear-registration">
<h2>Linear Versus Non-linear Registration<a class="headerlink" href="#linear-versus-non-linear-registration" title="Permalink to this heading">#</a></h2>
<p>To appreciate the differences between linear and non-linear methods, <a class="reference internal" href="#nonlin-norm-fig"><span class="std std-numref">Fig. 12</span></a> shows the results of warping the same brain we saw earlier using a non-linear approach. As we can see, the correspondence with the MNI template is not perfect, but it is much better than we achieved using an affine approach.</p>
<figure class="align-default" id="nonlin-norm-fig">
<a class="reference internal image-reference" href="_images/nonlin_norm.gif"><img alt="_images/nonlin_norm.gif" src="_images/nonlin_norm.gif" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Illustration of the correspondance between the MNI template and an image that has been non-linearly warped.</span><a class="headerlink" href="#nonlin-norm-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="unified-segmentation">
<h2>Unified segmentation<a class="headerlink" href="#unified-segmentation" title="Permalink to this heading">#</a></h2>
<p>As a final point for this section, it is worth noting that the current approach taken by <code class="docutils literal notranslate"><span class="pre">SPM</span></code> for spatial normalisation is to combine it with a procedure for segmenting structural MR images into their different tissue classes. This approach is known as <em>unified segmentation</em> and was introduced by <a class="reference external" href="https://www.fil.ion.ucl.ac.uk/~karl/Unified%20segmentation.pdf">Ashburner &amp; Friston (2005)</a>. The non-segmentation version of normalisation is still available in <code class="docutils literal notranslate"><span class="pre">SPM</span></code> as <code class="docutils literal notranslate"><span class="pre">Old</span> <span class="pre">Normalise</span></code>, but there is little reason to use it beyond historical curiosity.</p>
</section>
<section id="normalisation-in-spm">
<h2>Normalisation in <code class="docutils literal notranslate"><span class="pre">SPM</span></code><a class="headerlink" href="#normalisation-in-spm" title="Permalink to this heading">#</a></h2>
<p>The video below will demonstrate how to perform normalisation using <code class="docutils literal notranslate"><span class="pre">SPM12</span></code>. This example uses the anatomical dataset that can be downloaded from <a class="reference external" href="https://livemanchesterac.sharepoint.com/:u:/r/sites/UOM-FBMH-MSc-NCCN/Shared%20Documents/PCHN62141%20Functional%20Neuroanatomy/Learning%20Materials/Asynchronous/Week%205/1.%20Image%20Registration/Data/anat.nii?csf=1&amp;amp;web=0&amp;amp;e=TBvVB1&amp;amp;download=1">here</a>.</p>
<div style="max-width: 1280px"><div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;"><iframe src="https://livemanchesterac.sharepoint.com/sites/UOM-FBMH-MSc-NCCN/_layouts/15/embed.aspx?UniqueId=c9c8301a-f75b-4e46-ab42-473e17c68d47&embed=%7B%22hvm%22%3Atrue%2C%22ust%22%3Atrue%7D&referrer=StreamWebApp&referrerScenario=EmbedDialog.Create" width="1280" height="720" frameborder="0" scrolling="no" allowfullscreen title="spm-normalisation.mov" style="border:none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; height: 100%; max-width: 100%;"></iframe></div></div></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "jupyter_matlab_kernel"
        },
        kernelOptions: {
            name: "jupyter_matlab_kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'jupyter_matlab_kernel'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="5.registering-different-subs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Registering Images from Different Subjects</p>
      </div>
    </a>
    <a class="right-next"
       href="7.summary.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Summary</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deformation-fields">Deformation Fields</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-deformation-fields">Creating Deformation Fields</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regularisation">Regularisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-versus-non-linear-registration">Linear Versus Non-linear Registration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unified-segmentation">Unified segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalisation-in-spm">Normalisation in <code class="docutils literal notranslate"><span class="pre">SPM</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>